# <a name="introduction"></a>介绍

在 Microsoft&reg; Visual Basic&reg;编程语言是用于 Microsoft.NET Framework 的高级编程语言。 尽管它在设计上是一种易于使用，并轻松了解语言，还有功能强大，足以满足需求的经验丰富的程序员。 Visual Basic 编程语言都具有一种语法类似于英语，提高清晰度和 Visual Basic 代码的可读性。 如有可能，而不是缩写、 首字母缩写词或特殊字符使用有意义的词或短语。 外来或不需要的语法通常允许但不是必需的。

Visual Basic 编程语言可以是强类型化或松散类型化的语言。 松散类型化延迟很多类型检查，直到已运行程序的负担。 这包括不仅类型检查的转换，但还的方法调用，这意味着方法调用的绑定，可以延迟到运行时。 构建原型或其他程序在其中的开发速度比执行速度更重要时，这很有用。 Visual Basic 编程语言还提供强类型化语义执行所有类型在编译时检查并不允许的方法调用运行时绑定。 这可以保证最大性能并有助于确保正确的类型转换。 生成的执行和执行的速度在正确性非常重要的生产应用程序时，这很有用。

本文档介绍 Visual Basic 语言。 它旨在为完整的语言说明而不是语言教程或用户的参考手册。

## <a name="grammar-notation"></a>语法表示法

本规范描述两个 grammar： 词法语法和句法的语法。 词法语法定义如何对窗体标记; 组合字符语法的语法定义如何对窗体 Visual Basic 程序组合令牌。 此外，还有多个辅助语法，用于预处理操作，例如条件编译。

此规范中的语法用 ANTLR 格式--请参阅 http://www.antlr.org/。

用例是 Visual Basic 程序中并不重要。 为简单起见，所有终端会都提供标准大小写，但它们将匹配任何大小写。 由其对应的 ASCII 字符表示的是 ASCII 字符集中的可打印元素终端。 Visual Basic 时也是不区分宽度匹配终端，允许全角字符 Unicode 字符，以匹配其半角的 Unicode 等效项，但只能在整个令牌基础上。 如果它包含混合的半角和全宽字符，则令牌将不匹配。

换行符和缩进可能添加以提高可读性并不是生产环境的一部分。

## <a name="compatibility"></a>兼容性

一种编程语言的一个重要功能是该语言的不同版本之间的兼容性。 如果一种语言的较新版本不接受与以前版本的语言，相同的代码，或将其解释方式不同于以前的版本，然后负担时，可放置在上一名程序员他的代码从一个版本升级的语言到另一个。 在这种情况下，版本之间的兼容性必须保留除时为语言使用者带来的好处是清晰且难以忍受性质。

以下策略控制对 Visual Basic 语言版本之间的更改。 术语语言，在此上下文中使用时仅指 Visual Basic 语言本身的语法和语义方面，不包括任何.NET Framework 类作为的一部分包括`Microsoft.VisualBasic`命名空间 （和子命名空间）。 本文档的作用域之外的单独版本控制和兼容性策略包含在.NET Framework 中的所有类。

### <a name="kinds-of-compatibility-breaks"></a>类型的兼容性中断

在理想情况下，兼容性将为现有版本的 Visual Basic 和 Visual Basic 的所有将来的版本之间的 100%。 但是，可能有其中需兼容性中断可能会超过了成本的情况下它可能会施加于程序员。 这种情况下是：

* *新的警告。* 引入一个新的警告不、 本身，兼容性中断。 但是，许多开发人员使用"将警告视为错误"打开进行编译，因为额外必须格外小心引入警告时。

* *新的关键字。* 引入新语言功能时可能需要引入新的关键字。 将进行合理的努力，可以选择与用户的标识符发生冲突的可能性降至关键字还可以使用现有关键字非常有用。 若要从以前版本升级项目和转义任何新的关键字，将提供帮助。

* *编译器错误。* 语言规范中有案可稽行为促使编译器的行为时，修复匹配有案可稽的行为的编译器行为可能有必要。

* *规范错误。* 当编译器是与语言规范，但语言规范保持一致是明确的错误，更改语言规范，编译器行为可能有必要。 短语"显然是错误的"意味着有案可稽的行为与清晰而又明确大多数用户所期望的内容，并生成用户非常有必要行为。

* *规范二义性。* 当语言规范应当清楚在特定情况下，会发生情况的内容，但不会和编译器处理这种情况是不一致或明确错误 （使用从上一个点相同的定义） 的方式、 澄清规范和更正的编译器行为可能有必要。 换而言之，当规范包括用例 a、 b、 d 和 e，但省略任何提及的在 case c 中，会发生什么情况和在 c 中，则可能需要记录发生在 c 中大小写和更改以匹配的编译器行为的内容的情况下，编译器的行为不正确。 （请注意，如果该规范不明确的情况下会发生什么情况并和编译器的行为不明确问题时，编译器行为会变得实际上规范的方式。）

* *使成为编译时错误的运行时错误。* 在其中的代码是保证在运行时 （即用户代码有明确的 bug 中它） 时失败的 100%的情况下，可能需要添加捕获这种情况的编译时错误。

* *规范省略。* 当语言规范不会不是专门允许或禁止特定的情况和编译器处理这种情况是不可取 （如果编译器行为是明确的错误，它将为规范 bug，而不规范的方式省略的方式），它可能有必要以阐明规范，并更改编译器行为。 除了常用的影响分析，这种类型的更改并进一步限制为其中更改的影响应该是非常最小，为开发人员带来的好处是非常高的情况下。

* *新的功能。* 一般情况下，引入了新功能不应更改现有部件语言规范的或现有的编译器行为。 在其中引入了一项新功能需要更改现有的语言规范的情况下，此类的兼容性中断才合理影响会非常最小和功能的好处是高。

* *安全性。* 在异常情况下，安全问题可能需要兼容性中断，如删除或修改的功能在本质上是不安全，会带来安全风险的用户清除。

在以下情况下不是可接受引入兼容性中断的原因：

* *不需要或上的行为。* 这是合理的但被视为不合理或上以前的语言设计或编译器行为不破坏向后兼容性的理由。 必须改为使用该语言不推荐使用过程中，下面，将介绍。

* *别的东西。* 否则，编译器行为将保持向后兼容。

### <a name="impact-criteria"></a>影响条件

在考虑是否兼容性中断可能是可接受的用于确定更改的影响可能是多个条件。 影响越大，用于接受兼容性越高栏会中断。

条件是：

* 更改的范围是什么？ 换而言之，程序数量是否有可能受到影响？ 多少用户是否有可能受到影响？ 编写受此更改影响的代码是如何常见？

* 是否存在来获得相同的行为更改之前任何解决办法？

* 更改是如何明显？ 用户将获得即时反馈，某些内容已更改，或将其程序只需执行以不同方式？

* 可以更改进行合理的解决在升级过程？ 是否可以编写一个工具，可以找到这种情况中更改的发生是完美的准确性并更改代码以解决此更改？

* 什么是社区的反馈的更改上？

### <a name="language-deprecation"></a>语言不推荐使用

随着时间推移，可能会变得弃用语言或编译器的部分。 如前文所述，它不是可接受破坏兼容性，若要删除此类已弃用的功能。 相反，必须执行以下步骤：

1. 提供一种功能，版本中存在*A*必须的 Visual Studio 中，从上弃用的功能和完整的通知之前所做的任何最终不推荐使用决策给定的用户社区中请求的反馈。 不推荐使用过程可能会反转或放弃在用户社区的反馈基础的任意位置。

2. 完整版 （即，不点发行版） *B*的 Visual Studio 必须释放使用的不推荐使用的使用情况，则发出警告的编译器警告。 警告必须在默认情况下，可以关闭。 必须清楚地记录弃用功能在产品文档并在 web 上找到。

3. 完整版*C*的 Visual Studio 必须随无法关闭的编译器警告。

4. 完整版*D*的 Visual Studio 必须随后释放与不推荐使用的编译器警告转换为编译器错误。 发行*D*发行版的主流支持阶段 （5 年撰写本文时） 结束后必须出现*A*。

5. 最后，版本*E*的 Visual Studio 可能会发布中删除编译器错误。

不能在此不推荐使用框架中处理的更改将不允许。
